(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[410],{47302:function(e,t,n){"use strict";var r=n(73534),a=n(56581),s=n(97e3),i=n(25675),l=n(67294),c=n(82069),o=n(9113),u=n(9723),d=n(11163),m=n(80868),f=n(85893);function x(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,s=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw s}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.Z=function(e){var t,n=e.tab,p=e.profile_picture,h=(0,l.useState)(!1),v=h[0],b=h[1],g=(0,o.f)().data,N=(0,l.useState)(null),j=N[0],y=N[1],k=(0,l.useState)(0),w=k[0],_=k[1],S=(0,l.useState)([]),E=S[0],C=S[1],M=(0,m.r)().data,A=(0,r.e)().data,P=(0,a.T)(null===A||void 0===A?void 0:A.customer.data.id.toString()).data;(0,l.useEffect)((function(){M&&C(M.data)}),[M]),(0,l.useMemo)((function(){A&&y(A.customer.data)}),[A]);(0,l.useEffect)((function(){g&&_(g.unread-function(e){var t,n=0,r=x(E);try{for(r.s();!(t=r.n()).done;){var a=t.value;e.includes(a.inbox_conversation.data.id)&&u.E2.includes(a.inbox_message.data.type)&&(n+=1)}}catch(s){r.e(s)}finally{r.f()}return n}(g.reduce_conversation_unread_ids))}),[g]);var Z=[{line:9,total:w}],F=function(e){var t=Z.find((function(t){return t.line===e}));return t&&t.total>0?t:void 0};return(0,f.jsxs)("div",{className:"w-full m-auto flex flex-col",children:[(0,f.jsxs)("div",{className:"user-profile-block flex order-2 lg:order-1",children:[(0,f.jsx)("div",{className:"thumb mb-8 w-24",children:(0,f.jsx)(i.default,{className:"w-full",loader:s.k,src:p||(null===j||void 0===j?void 0:j.profile_picture)||"/assets/images/Default_Profile.svg",alt:"",width:96,height:96,objectFit:"cover"})}),(0,f.jsxs)("div",{className:"info mb-8 lg:mb-12 flex-1 pl-4",children:[(0,f.jsx)("div",{className:"font-helveticaNeue500 ratings flex items-center text-pink text-sm",children:P&&P.rate?(0,f.jsx)(c.Z,{rate:P.rate}):""}),(0,f.jsx)("h3",{className:"font-helveticaNeue500 text-dark uppercase text-2xl mb-1",children:(null===j||void 0===j?void 0:j.first_name)||"FirstName"}),(0,f.jsxs)("p",{className:"font-helveticaNeue500 text-dark uppercase text-xl mb-1",children:["@",(null===j||void 0===j?void 0:j.nickname)||"Username"]})]})]}),(0,f.jsxs)("div",{className:"aside-nav-wrap order-1 -mx-6 lg:mx-0 mb-8 lg:mb-0 lg:order-2",children:[(0,f.jsx)("div",{className:"account-nav-toggle-mobile bg-pink text-white lg:hidden",children:(0,f.jsxs)("div",{className:"relative bg-pink text-[14px] font-medium leading-none text-white lg:hidden uppercase pt-[25px] pb-[14px] px-[18px] cursor-pointer",onClick:function(){b(!v)},children:[null===(t=u.NP.find((function(e,t){return t+1===n&&e})))||void 0===t?void 0:t.label,(0,f.jsx)("div",{className:"".concat(v?"-rotate-45":""," absolute top-6 right-[10px] inline-block cursor-pointer transition-all float-right"),children:(0,f.jsx)(i.default,{src:"/assets/icons/plus-2.svg",alt:"",width:14,height:14})})]})}),(0,f.jsx)("div",{id:"account-nav",className:"inner bg-lightGrey lg:block px-6 lg:px-0 ".concat(v?"":"hidden"),children:u.NP.map((function(e,t){var r;return(0,f.jsxs)("div",{className:"pr-4 flex block cursor-pointer border-b text-dark border-b-dark bg-account-nav bg-no-repeat bg-right-center ".concat(n===t+1&&"text-pink border-b-pink bg-none"),onClick:function(){return d.default.push("/my-account".concat(e.path))},children:[(0,f.jsx)("div",{className:"font-helveticaNeue500 pt-7 pb-6 leading-none tracking-0 uppercase text-[18px]",children:e.label}),F(t)&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:"text-pink pl-1 pt-9 pb-6 font-helveticaNeue500 text-[16px] leading-[0px] tracking-0",children:"("}),(0,f.jsx)("div",{className:"text-pink pt-[33px] pb-6 font-helveticaNeue500 text-[16px] leading-[0px] tracking-0",children:null===(r=F(t))||void 0===r?void 0:r.total}),(0,f.jsx)("div",{className:"text-pink pt-9 pb-6 font-helveticaNeue500 text-[16px] leading-[0px] tracking-0",children:")"})]})]},e.label.toString())}))})]})]})}},82069:function(e,t,n){"use strict";var r=n(67294),a=n(25675),s=n(85893);t.Z=function(e){var t=e.rate,n=e.values,i=e.size||12,l=(0,r.useState)(0),c=l[0],o=l[1],u=(0,r.useState)(!1),d=u[0],m=u[1];return(0,r.useEffect)((function(){!function(){var e=parseInt(t.toString()),n=t-e;e>0&&o(e),n>0&&m(!0)}()}),[t]),(0,s.jsxs)("div",{className:"flex",children:[function(){for(var e=[],t=0;t<5;t++)e.push("rating-".concat(t+1));return e}().map((function(e,t){return(0,s.jsx)("div",{className:"mr-[4px]",children:t<c?(0,s.jsx)(a.default,{className:"cursor-pointer",src:"/assets/icons/rating-1.svg",alt:"icon rating",width:i,height:i}):d&&t===c?(0,s.jsx)(a.default,{className:"cursor-pointer",src:"/assets/icons/rating-2.svg",alt:"icon rating",width:i,height:i}):(0,s.jsx)(a.default,{className:"cursor-pointer",src:"/assets/icons/rating-3.svg",alt:"icon rating",width:i,height:i})},e.toString())})),(0,s.jsxs)("span",{className:"text-pink ".concat(i>12?"text-[14px] pt-[1px]":"text-[12px] -mt-[2px]"),children:["(",n,")"]})]})}},56581:function(e,t,n){"use strict";n.d(t,{T:function(){return s}});var r=n(46837),a=n(88767),s=function(e){return(0,a.useQuery)("seller_info",(function(){return(0,r.h)("users/".concat(e,"/info"))}),{enabled:!!e})}},58191:function(e,t,n){"use strict";n.d(t,{wf:function(){return i},zU:function(){return l},Hj:function(){return c},Li:function(){return o}});var r=n(46837),a=n(88767),s=n(5887),i=function(){var e=(0,s.J)().isLoggedIn;return(0,a.useQuery)("my_payment_methods",(function(){return(0,r.h)("me/cards")}),{refetchOnWindowFocus:!1,enabled:!!e,retry:0})},l=function(){return(0,a.useMutation)((function(e){return(0,r.h)("users/me/card/default/".concat(e.source),{method:"put"})}))},c=function(){return(0,a.useMutation)((function(e){return(0,r.h)("me/cards",{method:"post",body:JSON.stringify(e)})}))},o=function(){return(0,a.useMutation)((function(e){return(0,r.h)("/me/delete-card",{method:"POST",body:JSON.stringify(e)})}))}},44149:function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var r=n(46837),a=n(88767),s=n(5887),i=function(){var e=(0,s.J)().isLoggedIn;return(0,a.useQuery)("myProfile",(function(){return(0,r.h)("me/profile",{method:"get"})}),{refetchOnWindowFocus:!1,enabled:e})}},16648:function(e,t,n){"use strict";n.r(t),n.d(t,{StripeForm:function(){return j}});var r=n(15861),a=n(87757),s=n.n(a),i=n(47302),l=n(9008),c=n(54465),o=n(86664),u=n(67294),d=n(94649),m=n(22283),f=n(27335),x=n(58191),p=n(44149),h=n(22887),v=n(11163),b=n(85893),g={base:{fontSize:"14px",lineHeight:"48px",color:"black","::placeholder":{color:"#B4B4B4"}},invalid:{color:"red"}},N=(0,c.J)("".concat("pk_test_51KW0ZFJiMSsjx6P4bqT1yF4EUMX7sLDMmZy0ZKildgGp0dNy4406wP25fXjTN2Zkp8D34IIwbi5diVyGygdVF3jK007yoDUzos")),j=function(){var e=(0,o.useStripe)(),t=(0,o.useElements)(),n=(0,u.useState)(!1),a=n[0],i=n[1],l=(0,x.Hj)(),c=l.mutate,N=l.isLoading,j=l.error,y=l.isError,k=(0,p.e)().data,w=(0,u.useState)(!1),_=w[0],S=w[1],E=(0,x.zU)().mutate,C=(0,v.useRouter)(),M=(0,d.TA)({enableReinitialize:!0,initialValues:{stripe_name:"",default_payment:!1},validationSchema:m.LD,onSubmit:function(){a||N||A()}}),A=function(){var n=(0,r.Z)(s().mark((function n(){var r,a,l,u,d,m,f;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i(!0),r={owner:{name:M.values.stripe_name,email:null===k||void 0===k?void 0:k.email}},null!=t){n.next=4;break}return n.abrupt("return");case 4:if(a=t.getElement(o.CardNumberElement),l=t.getElement(o.CardExpiryElement),u=t.getElement(o.CardCvcElement),!(e&&t&&a&&l&&u)){n.next=17;break}return n.next=10,e.createSource(a,r);case 10:if(d=n.sent,m=d.error,f=d.source,!m&&f){n.next=16;break}return S(!0),n.abrupt("return");case 16:c({source:null===f||void 0===f?void 0:f.id},{onSuccess:function(){M.values.default_payment&&f?E({source:f.id},{onSuccess:function(){return C.push("/my-account/payment-methods")}}):C.push("/my-account/payment-methods")},onError:function(){i(!1)}});case 17:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)(f.Z,{name:"stripe_name",label:"Name on card",labelClasses:"text-sm",onChange:M.handleChange,value:M.values.stripe_name,errorMessage:M.errors.stripe_name&&M.touched.stripe_name?M.errors.stripe_name:""})}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"label font-helveticaNeue500 text-sm uppercase block mb-2",children:"Card number"}),(0,b.jsx)(o.CardNumberElement,{options:{placeholder:"",style:g},className:"font-helveticaNeue400 border border-mgrey h-12 block outline-0 w-full text-sm px-4 text-dark rounded-none"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap -mx-2",children:[(0,b.jsx)("div",{className:"w-2/4 px-2",children:(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"label font-helveticaNeue500 text-sm uppercase block mb-2",children:"Expiry date"}),(0,b.jsx)(o.CardExpiryElement,{options:{placeholder:"",style:g},className:"font-helveticaNeue400 border border-mgrey h-12 block outline-0 w-full text-sm px-4 text-dark rounded-none"})]})}),(0,b.jsx)("div",{className:"w-2/4 px-2",children:(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"label font-helveticaNeue500 text-sm uppercase block mb-2",children:"CVC"}),(0,b.jsx)(o.CardCvcElement,{options:{placeholder:"",style:g},className:"font-helveticaNeue400 border border-mgrey h-12 block outline-0 w-full text-sm px-4 text-dark rounded-none"})]})})]}),(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)("div",{onClick:M.submitForm,className:"font-helveticaNeue500 text-center px-3 transition-all border border-dark text-white bg-dark hover:border-dark hover:text-dark hover:bg-white py-4 text-xs block w-full uppercase tracking-widest ".concat(a||N?"":"cursor-pointer"),children:a||N?"saving":"save payment method"})}),_?(0,b.jsx)(h.Z,{message:"Error processing payment"}):"",!a&&y&&""!==j.message?(0,b.jsx)(h.Z,{message:j.message}):""]})};t.default=function(){return(0,b.jsxs)("div",{children:[(0,b.jsxs)(l.default,{children:[(0,b.jsx)("title",{children:"GanniRepeat - My Account - Add Payment Methods"}),(0,b.jsx)("meta",{name:"description",content:"GanniRepeat - My Account - Add Payment Methods"}),(0,b.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,b.jsx)("main",{className:"text-dark font-helveticaNeue400 text-sm overflow-x-hidden font-normal",children:(0,b.jsxs)("div",{className:"flex flex-wrap lg:bg-lightGrey",children:[(0,b.jsx)("div",{className:"lg:py-12 px-6 lg:px-12 w-full lg:w-480",children:(0,b.jsx)(i.Z,{tab:4})}),(0,b.jsxs)("div",{className:"bg-white py-6 lg:py-12 px-6 lg:px-20 w-full lg:w-auto lg:flex-1",children:[(0,b.jsx)("h3",{className:"font-helveticaNeue500 uppercase text-2xl mb-2",children:"My Account"}),(0,b.jsx)("h2",{className:"font-helveticaNeue500 uppercase text-green text-4xl lg:text-5xl mb-2",children:"Payment methods"}),(0,b.jsx)("div",{className:"mt-12",children:(0,b.jsx)("hr",{className:"border-t-grey my-8"})}),(0,b.jsx)("form",{children:(0,b.jsx)(o.Elements,{stripe:N,children:(0,b.jsx)(j,{})})})]})]})})]})}},96742:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/my-account/payment-methods/add",function(){return n(16648)}])}},function(e){e.O(0,[9101,9774,2888,179],(function(){return t=96742,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
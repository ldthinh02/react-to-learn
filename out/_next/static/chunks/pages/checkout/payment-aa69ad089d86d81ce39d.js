(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8475],{6746:function(e,n,s){"use strict";s.d(n,{N:function(){return r}});s(67294);var a=s(85893),r=function(e){var n=e.active,s=e.onChange,r=e.classes,t=e.label,i=e.value,d=e.name,l=e.disabled,c=void 0!==l&&l,o=e.labelClasses;return(0,a.jsxs)("label",{className:"custom-radio cursor-pointer block ".concat(o),children:[(0,a.jsx)("input",{type:"radio",className:"hidden",value:i,onChange:s,name:d,disabled:c}),(0,a.jsxs)("span",{className:"relative block pl-6",children:[(0,a.jsx)("span",{className:"absolute top-px left-0 ".concat(n?"bg-black":"bg-white"," border border-dark block w-[12px] h-[12px] rounded-full ").concat(r)}),n&&(0,a.jsx)("span",{className:"absolute top-[3px] left-[2px] w-[8px] h-[8px] rounded-full bg-white border-dark block"}),t]})]})}},88275:function(e,n,s){"use strict";s.d(n,{e:function(){return l}});var a=s(4942),r=s(14671),t=s(38597);function i(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),s.push.apply(s,a)}return s}function d(e){for(var n=1;n<arguments.length;n++){var s=null!=arguments[n]?arguments[n]:{};n%2?i(Object(s),!0).forEach((function(n){(0,a.Z)(e,n,s[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(s,n))}))}return e}var l=(0,r.Z)((0,t.tJ)((function(e){return{cartConfirmed:null,setCartConfirmed:function(n){e(n?function(){return{cartConfirmed:d({},n)}}:function(){return{cartConfirmed:null}})}}}),{name:"cartConfirmed"}))},58191:function(e,n,s){"use strict";s.d(n,{wf:function(){return i},zU:function(){return d},Hj:function(){return l},Li:function(){return c}});var a=s(46837),r=s(88767),t=s(5887),i=function(){var e=(0,t.J)().isLoggedIn;return(0,r.useQuery)("my_payment_methods",(function(){return(0,a.h)("me/cards")}),{refetchOnWindowFocus:!1,enabled:!!e,retry:0})},d=function(){return(0,r.useMutation)((function(e){return(0,a.h)("users/me/card/default/".concat(e.source),{method:"put"})}))},l=function(){return(0,r.useMutation)((function(e){return(0,a.h)("me/cards",{method:"post",body:JSON.stringify(e)})}))},c=function(){return(0,r.useMutation)((function(e){return(0,a.h)("/me/delete-card",{method:"POST",body:JSON.stringify(e)})}))}},76871:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return P}});var a=s(15861),r=s(42982),t=s(87757),i=s.n(t),d=s(98893),l=s(27335),c=s(6746),o=s(3732),u=s(38539),m=s(90025),p=s(58191),h=s(9008),f=s(11163),b=s(67294),x=s(54465),g=s(86664),v=s(22887),_=s(22283),j=s(94649),N=s(5887),y=s(88275),w=s(87517),k=s(22e3),C=s(85893),E={base:{fontSize:"14px",lineHeight:"48px",color:"black","::placeholder":{color:"#B4B4B4"}},invalid:{color:"red"}},S=(0,x.J)("".concat("pk_test_51KW0ZFJiMSsjx6P4bqT1yF4EUMX7sLDMmZy0ZKildgGp0dNy4406wP25fXjTN2Zkp8D34IIwbi5diVyGygdVF3jK007yoDUzos"));function O(){var e=(0,g.useStripe)(),n=(0,g.useElements)(),s=(0,b.useState)(!1),t=s[0],x=s[1],S=(0,b.useState)(""),O=S[0],P=S[1],A=(0,b.useState)(null),Z=A[0],D=A[1],M=(0,b.useState)([]),I=M[0],L=M[1],T=(0,b.useState)("same_as_shipping"),F=T[0],J=T[1],U=(0,b.useState)(!1),B=U[0],G=U[1],V=(0,b.useState)(""),z=V[0],R=V[1],H=(0,b.useState)(),X=H[0],q=H[1],K=(0,b.useState)(!1),W=K[0],Q=K[1],$=(0,w.u)().browserCurrency,Y=(0,b.useState)(!1),ee=Y[0],ne=Y[1],se=(0,b.useState)(""),ae=se[0],re=se[1],te=(0,N.J)().isLoggedIn,ie=(0,f.useRouter)(),de=(0,p.wf)(),le=de.data,ce=de.isSuccess,oe=(0,m._)().data,ue=(0,u.$r)().refetch,me=(0,p.Hj)(),pe=me.mutate,he=me.error,fe=me.isError,be=(0,p.zU)(),xe=be.mutate,ge=be.isLoading,ve=(0,u.Vc)(),_e=ve.mutate,je=ve.isLoading,Ne=(0,u.Be)(),ye=Ne.mutate,we=Ne.isLoading,ke=Ne.isSuccess,Ce=(0,u.EG)(),Ee=Ce.mutate,Se=Ce.isLoading,Oe=(0,u.sj)().mutate,Pe=(0,u.nc)().mutate,Ae=(0,u.HO)(),Ze=Ae.mutate,De=Ae.isLoading,Me=(0,o.jD)((function(e){return e.cart})),Ie=(0,o._3)((function(e){return e.listing_data})),Le=(0,o.jD)((function(e){return e.setCart})),Te=(0,y.e)().setCartConfirmed;(0,b.useMemo)((function(){if(ce)if(le&&le.card_source.data.length>0){var e=(0,r.Z)(le.card_source.data),n=e.findIndex((function(e){return e.id===le.default}));-1!==n&&(D(le.card_source.data[n]),B||(G(!0),P("default_payment")),e.splice(n,1)),L(e),-1!==n||O||B||(P("other_payment"),G(!0))}else P("new_payment"),G(!0)}),[le]);var Fe=(0,j.TA)({enableReinitialize:!0,initialValues:{stripe_name:""},validationSchema:_.LD,onSubmit:function(){Ve()}}),Je=function(e){P(e.target.value)},Ue=function(e){q(e.target.value)},Be=function(e){var n;"same_as_shipping"===e.target.value?q(null===Me||void 0===Me||null===(n=Me.shipping_address)||void 0===n?void 0:n.data.id.toString()):"different_from_shipping"===e.target.value&&q("");J(e.target.value)},Ge=function(e){xe({source:e.target.value},{onSuccess:function(){return R(e.target.value)}})},Ve=function(){var s=(0,a.Z)(i().mark((function s(){var a,r,t,d,l,c,o;return i().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(ne(!1),a={owner:{name:Fe.values.stripe_name,email:null===Me||void 0===Me?void 0:Me.email}},null!=n){s.next=4;break}return s.abrupt("return");case 4:if(r=n.getElement(g.CardNumberElement),t=n.getElement(g.CardExpiryElement),d=n.getElement(g.CardCvcElement),!(e&&n&&r&&t&&d)){s.next=17;break}return s.next=10,e.createSource(r,a);case 10:if(l=s.sent,c=l.error,o=l.source,!c&&o){s.next=16;break}return ne(!0),s.abrupt("return");case 16:pe({source:o.id},{onSuccess:function(){ze(o.id)},onError:function(e){re(e.message),Q(!1)}});case 17:case"end":return s.stop()}}),s)})));return function(){return s.apply(this,arguments)}}(),ze=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=n||X;if(!s){var a;if("same_as_shipping"!==F)return;s=null===Me||void 0===Me||null===(a=Me.shipping_address_id)||void 0===a?void 0:a.toString()}_e({address_id:Number(s)},{onSuccess:function(){Oe({fallback_language:"en"},{onSuccess:function(){Ee({fallback_language:"en"},{onSuccess:function(){Me&&Me.shipping_address_id&&Me.products&&ye({billing_adddress_id:Number(s),fallback_language:"en",shipping_address_id:Me.shipping_address_id,source_id:e,product_ids:Me.products.data.map((function(e){return e.id})),selectedCurrency:$.currency},{onSuccess:function(){ue(),Te(Me),Le(null),ie.push("/checkout/order-confirmed")},onError:function(e){if(Q(!1),e instanceof Error){var n=JSON.parse(e.message);"requires_action"===n.message&&ie.replace(n.next_action.redirect_to_url.url)}re(e.message)}})},onError:function(e){Q(!1),re(e.message)}})},onError:function(e){Q(!1),re(e.message)}})}})},Re=function(){var s=(0,a.Z)(i().mark((function s(){var r,t,d,l,c,o,u;return i().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(ne(!1),r={owner:{name:Fe.values.stripe_name,email:null===Me||void 0===Me?void 0:Me.email}},null!=n){s.next=4;break}return s.abrupt("return");case 4:if(t=n.getElement(g.CardNumberElement),d=n.getElement(g.CardExpiryElement),l=n.getElement(g.CardCvcElement),!(e&&n&&t&&d&&l)){s.next=17;break}return s.next=10,e.createSource(t,r);case 10:if(c=s.sent,o=c.error,u=c.source,!o&&u){s.next=16;break}return ne(!0),s.abrupt("return");case 16:Ze({state:{payout:{payment_method_name:"CREDIT_CARD",card_source:u.id}},listing_id:Ie.id,guest_id:Ie.guest_id,first_name:Fe.values.stripe_name},{onSuccess:function(){Me&&Me.shipping_address_id&&_e({address_id:Me.shipping_address_id},{onSuccess:function(){Ee({fallback_language:"en"},{onSuccess:function(){var e=(0,a.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Me&&Me.shipping_address_id&&Me.products&&ye({billing_adddress_id:Me.shipping_address_id,fallback_language:"en",shipping_address_id:Me.shipping_address_id,source_id:u.id,product_ids:Me.products.data.map((function(e){return e.id})),selectedCurrency:$.currency},{onSuccess:function(){ue(),Te(Me),Le(null),ie.push("/checkout/order-confirmed")},onError:function(e){if(Q(!1),e instanceof Error){var n=JSON.parse(e.message);"requires_action"===n.message&&ie.replace(n.next_action.redirect_to_url.url)}re(e.message)}});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onError:function(e){Q(!1),re(e.message)}})},onError:function(e){Q(!1),re(e.message)}})}});case 17:case"end":return s.stop()}}),s)})));return function(){return s.apply(this,arguments)}}();return(0,C.jsxs)("div",{children:[(0,C.jsxs)(h.default,{children:[(0,C.jsx)("title",{children:"Buy and Sell GANNI Pre-loved Fashion on GANNIREPEAT | Payment"}),(0,C.jsx)("meta",{name:"description",content:"Extend the life of your wardrobe with GANNIREPEAT: The Easiest and Safest Payment of your Order of Pre-loved GANNI Clothes, Shoes and Accessories."}),(0,C.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,C.jsxs)("div",{className:"flex flex-wrap lg:bg-lightGrey flex-row-reverse mt-2",children:[(0,C.jsx)(d.O,{showMobileViewOrder:t,toggleMobileViewOrder:function(){x(!t)}}),(0,C.jsx)("div",{className:"bg-white py-6 lg:py-12 px-6 lg:px-20 w-full lg:w-form-checkout lg:flex-1",children:(0,C.jsx)("div",{className:"flex flex-wrap tabs",id:"tabs-id",children:(0,C.jsxs)("div",{className:"w-full",children:[(0,C.jsxs)("ul",{className:"flex mb-0 list-none pt-3 pb-4 flex-row tabs-nav",children:[(0,C.jsx)("li",{className:"-mb-px mr-2 last:mr-0 w-3/4 text-center",children:(0,C.jsxs)("a",{className:"text-xs font-helveticaNeue400 px-5 py-3 rounded block leading-normal text-green",children:[(0,C.jsx)("span",{className:"icon w-[18px] h-[21px] block m-auto bg-no-repeat bg-center bg-100% mb-[5px] bg-gannirepeat-green",children:"\xa0"}),"1.Login"]})}),(0,C.jsx)("li",{className:"-mb-px mr-2 last:mr-0 w-3/4 text-center",children:(0,C.jsxs)("a",{className:"text-xs font-helveticaNeue400 px-5 py-3 rounded block leading-normal text-green",children:[(0,C.jsx)("span",{className:"icon w-[18px] h-[21px] block m-auto bg-no-repeat bg-center bg-100% mb-[5px] bg-gannirepeat-green",children:"\xa0"}),"2.Delivery"]})}),(0,C.jsx)("li",{className:"-mb-px mr-2 last:mr-0 w-3/4 text-center",children:(0,C.jsxs)("a",{className:"text-xs font-helveticaNeue400 px-5 py-3 rounded block leading-normal text-green",children:[(0,C.jsx)("span",{className:"icon w-[18px] h-[21px] block m-auto bg-no-repeat bg-center bg-100% mb-[5px] bg-gannirepeat-green",children:"\xa0"}),"3.Payment"]})})]}),(0,C.jsx)("div",{className:"relative flex flex-col min-w-0 break-words bg-white w-full mb-6 rounded",children:(0,C.jsx)("div",{className:"py-5 flex-auto",children:(0,C.jsx)("div",{className:"tab-content tab-space",children:(0,C.jsxs)("div",{className:"block",id:"tab-payment",children:[(0,C.jsx)("h2",{className:"font-helveticaNeue500 uppercase text-dark text-2xl mb-6",children:"Payment method"}),(0,C.jsxs)("form",{children:[Z?(0,C.jsxs)("div",{className:"address-accordion py-6 border-b border-b-grey open",children:[(0,C.jsx)(c.N,{label:"Use default payment method",value:"default_payment",name:"paymentMethod",onChange:Je,active:"default_payment"===O}),(0,C.jsx)("div",{className:"address-collapse py-6 ".concat("default_payment"===O?"":"hidden"),children:(0,C.jsx)("div",{className:"flex flex-wrap",children:(0,C.jsx)("div",{className:"w-full md:w-2/4",children:(0,C.jsxs)("p",{className:"font-helveticaNeue400 text-sm not-italic mb-4",children:[Z.name," ",(0,C.jsx)("br",{}),"Card ending in \u2022\u2022\u2022\u2022 ",Z.last4]})})})})]}):"",I&&I.length>0?(0,C.jsxs)("div",{className:"address-accordion py-6 border-b border-b-grey",children:[(0,C.jsx)(c.N,{label:"Use other saved payment",value:"other_payment",name:"paymentMethod",onChange:Je,active:"other_payment"===O,labelClasses:"mb-4 ".concat("other_payment"===O?"hidden":"")}),(0,C.jsx)("div",{className:"address-collapse py-6 ".concat("other_payment"===O?"":"hidden"),children:(0,C.jsx)("div",{className:"flex flex-wrap",children:I.map((function(e,n){var s;return(0,C.jsxs)("div",{className:"w-full md:w-2/4 mb-8",children:[(0,C.jsx)(c.N,{label:"Use this card",value:null===(s=e.id)||void 0===s?void 0:s.toString(),name:"other_cards",onChange:Ge,active:z==e.id,labelClasses:"mb-4",disabled:ge}),(0,C.jsxs)("p",{className:"font-helveticaNeue400 text-sm not-italic mb-4",children:[e.name," ",(0,C.jsx)("br",{}),"Card ending in \u2022\u2022\u2022\u2022 ",e.last4]})]},n)}))})}),ge?(0,C.jsx)("div",{className:"text-center",children:"Please wait..."}):""]}):"",(0,C.jsxs)("div",{className:"address-accordion py-6 border-b border-b-grey",children:[le&&0!==le.card_source.data.length?(0,C.jsx)(c.N,{label:"Add new payment method",value:"new_payment",name:"paymentMethod",onChange:Je,active:"new_payment"===O,labelClasses:"mb-4"}):"",(0,C.jsxs)("span",{className:"".concat("new_payment"!==O&&te?"hidden":""),children:[(0,C.jsx)("div",{className:"mb-6",children:(0,C.jsx)(l.Z,{name:"stripe_name",label:"Name on card",labelClasses:"text-sm",onChange:Fe.handleChange,value:Fe.values.stripe_name,errorMessage:Fe.errors.stripe_name&&Fe.touched.stripe_name?Fe.errors.stripe_name:""})}),(0,C.jsxs)("div",{className:"mb-6",children:[(0,C.jsx)("label",{className:"label font-helveticaNeue500 text-sm uppercase block mb-2",children:"Card number"}),(0,C.jsx)(g.CardNumberElement,{options:{placeholder:"",style:E},className:"font-helveticaNeue400 border border-mgrey h-12 block outline-0 w-full text-sm px-4 text-dark rounded-none"})]}),(0,C.jsxs)("div",{className:"flex flex-wrap -mx-2",children:[(0,C.jsx)("div",{className:"w-2/4 px-2",children:(0,C.jsxs)("div",{className:"mb-6",children:[(0,C.jsx)("label",{className:"label font-helveticaNeue500 text-sm uppercase block mb-2",children:"Expiry date"}),(0,C.jsx)(g.CardExpiryElement,{options:{placeholder:"",style:E},className:"font-helveticaNeue400 border border-mgrey h-12 block outline-0 w-full text-sm px-4 text-dark rounded-none"})]})}),(0,C.jsx)("div",{className:"w-2/4 px-2",children:(0,C.jsxs)("div",{className:"mb-6",children:[(0,C.jsx)("label",{className:"label font-helveticaNeue500 text-sm uppercase block mb-2",children:"CVC"}),(0,C.jsx)(g.CardCvcElement,{options:{placeholder:"",style:E},className:"font-helveticaNeue400 border border-mgrey h-12 block outline-0 w-full text-sm px-4 text-dark rounded-none"})]})})]}),ee?(0,C.jsx)(v.Z,{message:"Error processing payment"}):"",!W&&fe&&""!==he.message?(0,C.jsx)(v.Z,{message:he.message}):""]})]}),(0,C.jsx)("h3",{className:"font-helveticaNeue400 text-lg mt-12",children:"Billing address"}),(0,C.jsxs)("div",{className:"address-accordion py-6 border-b border-b-grey open",children:[(0,C.jsx)(c.N,{label:"Billing address is the same as shipping",value:"same_as_shipping",name:"billingAddress",onChange:Be,active:"same_as_shipping"===F}),(0,C.jsx)("div",{className:"address-collapse py-6 ".concat("same_as_shipping"===F?"":"hidden"),children:(0,C.jsx)("div",{className:"flex flex-wrap",children:(0,C.jsx)("div",{className:"w-full md:w-2/4",children:Me&&Me.shipping_address?(0,C.jsxs)("address",{className:"font-helveticaNeue400 text-sm not-italic",children:[Me.shipping_address.data.first_name," ",Me.shipping_address.data.last_name," ",(0,C.jsx)("br",{}),Me.shipping_address.data.address_1,(0,C.jsx)("br",{}),Me.shipping_address.data.city,(0,C.jsx)("br",{}),Me.shipping_address.data.zipcode,(0,C.jsx)("br",{}),Me.shipping_address.data.country,(0,C.jsx)("br",{}),"+",Me.shipping_address.data.phone_code," ",Me.shipping_address.data.phone,(0,C.jsx)("br",{})]}):""})})})]}),Me&&Me.shipping_address&&oe&&oe.length>1?(0,C.jsxs)("div",{className:"address-accordion py-6 border-b border-b-grey",children:[(0,C.jsx)(c.N,{label:"Use a different billing address",value:"different_from_shipping",name:"billingAddress",onChange:Be,active:"different_from_shipping"===F,labelClasses:"".concat("different_from_shipping"===F?"hidden":"")}),(0,C.jsx)("div",{className:"address-collapse py-6 ".concat("different_from_shipping"===F?"":"hidden"),children:(0,C.jsx)("div",{className:"flex flex-wrap",children:oe.map((function(e,n){var s,a,r;return e.id===(null===Me||void 0===Me||null===(s=Me.shipping_address)||void 0===s?void 0:s.data.id)?"":(0,C.jsxs)("div",{className:"w-full md:w-2/4",children:[(0,C.jsx)(c.N,{label:"Use this address",value:null===(a=e.id)||void 0===a?void 0:a.toString(),name:"billingAddress",onChange:Ue,active:X===(null===(r=e.id)||void 0===r?void 0:r.toString()),labelClasses:"mb-4"}),(0,C.jsxs)("address",{className:"font-helveticaNeue400 text-sm not-italic mb-4",children:[e.first_name," ",e.last_name," ",(0,C.jsx)("br",{}),e.address_1,(0,C.jsx)("br",{}),e.city,(0,C.jsx)("br",{}),e.zipcode,(0,C.jsx)("br",{}),e.country,(0,C.jsx)("br",{}),"+",e.phone_code," ",e.phone,(0,C.jsx)("br",{})]})]},n)}))})})]}):"",(0,C.jsxs)("div",{className:"address-accordion py-6 border-b border-b-grey",children:[(0,C.jsx)(c.N,{label:te?"Add new address":"Other billing address",value:"new_address",name:"billingAddress",onChange:Be,active:"new_address"===F}),(0,C.jsx)("div",{className:"address-collapse py-6  ".concat("new_address"===F?"":"hidden"),children:(0,C.jsx)(k.Z,{onChangeValue:function(e){Pe(e,{onSuccess:function(e){var n=e.billing_address.data.id;"new_payment"!==O&&te?"default_payment"===O&&Z?ze(Z.id,n):"other_payment"===O&&ze(z,n):Fe.submitForm()},onError:function(e){re(e.message),Q(!1)}})}})})]})]}),(0,C.jsxs)("div",{className:"mb-6",children:[ae&&!W&&(0,C.jsx)(v.Z,{message:ae}),(0,C.jsx)("button",{onClick:function(){var e;(Q(!0),te)?"new_address"!==F?"new_payment"!==O&&te?"default_payment"===O&&Z?ze(Z.id):"other_payment"===O&&ze(z):Fe.submitForm():null===(e=document.getElementById("createAddressForm"))||void 0===e||e.click():Re()},className:"font-helveticaNeue500 text-center px-3 transition-all  border border-dark inline-block text-white bg-dark hover:border-dark hover:text-dark hover:bg-white text-xs uppercase w-full py-4 tracking-widest",disabled:je||we||ke||Se||De,children:W?"Processing...":"place order"})]})]})})})})]})})})]})]})}function P(){return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(g.Elements,{stripe:S,children:(0,C.jsx)(O,{})})})}},91874:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout/payment",function(){return s(76871)}])}},function(e){e.O(0,[9101,2e3,8893,9774,2888,179],(function(){return n=91874,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9850],{44258:function(e,t,n){n.d(t,{Z:function(){return y}});var r=n(42982),a=n(67294),s=n(25675),i=n(64111),l=n(46837),o=n(88767),c=n(41609),u=n.n(c),d=n(27484),f=n.n(d),m=n(94649),x=n(22283),h=n(27335),p=n(15861),b=n(87757),v=n.n(b),g=n(97e3),N=n(9723),j=n(85893),y=function(e){var t,n,c,d,b,y,k,w,_=e.active,S=e.toggleActive,C=e.productDetail,M=e.profile,O=e.buyer_id,Z=e.receiver,E=(0,a.useState)([]),T=E[0],z=E[1],F=(0,a.useState)(),P=F[0],R=F[1],A=(0,i.s)(),D=A.mutate,I=A.isLoading,U=(0,o.useMutation)((function(e){return(0,l.h)("inbox/conversations",{method:"POST",body:JSON.stringify(e)})})),J=U.mutate,L=U.isLoading,Y=(0,o.useMutation)(function(){var e=(0,p.Z)(v().mark((function e(t){var n,r,a,s,i,o,c,u,d,f,m,x;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.product,r=t.profile,a=t.setConversation,s=t.setMessages,i=t.setSeller,o=t.setBuyer,c=t.setIsProductSeller,e.next=3,(0,l.h)("inbox/conversations/product/".concat(n.id,"/customer/").concat(null===r||void 0===r?void 0:r.id),{method:"get"});case 3:if(!(u=e.sent)){e.next=13;break}return a(u),i(null===(d=u.product)||void 0===d?void 0:d.data.user.data.customer.data),o(null===(f=u.customer)||void 0===f?void 0:f.data.customer.data),c((null===(m=u.product)||void 0===m?void 0:m.data.user.data.id)===(null===r||void 0===r?void 0:r.id)),e.next=11,(0,l.h)("inbox/conversations/".concat(u.id,"/messages"),{method:"get"});case 11:x=e.sent,s(x);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).mutate,V=(0,a.useState)(),H=V[0],B=V[1],G=(0,a.useState)(),K=G[0],Q=G[1],q=(0,a.useState)(),W=q[0],X=q[1];(0,a.useEffect)((function(){C&&Y({product:C,profile:M,setConversation:R,setMessages:z,setSeller:B,setBuyer:Q,setIsProductSeller:X})}),[C]);var $=(0,m.TA)({initialValues:{message:""},validationSchema:x.r7,onSubmit:function(e){!P||u()(P)?J({product_id:Number(C.id),title:null===C||void 0===C?void 0:C.name,buyer_id:O||null},{onSuccess:function(t){R(t),D({conversation_id:Number(t.id),message:e.message},{onSuccess:function(e){var t=(0,r.Z)(T);t.push(e),z(t),te(),$.setFieldValue("message","")}})}}):D({conversation_id:Number(null===P||void 0===P?void 0:P.id),message:e.message},{onSuccess:function(e){var t=(0,r.Z)(T);t.push(e),z(t),te(),$.setFieldValue("message","")}})}}),ee=(0,a.useRef)(null),te=function(){ee&&ee.current&&(ee.current.scrollTop=ee.current.scrollHeight)};return(0,j.jsx)("div",{className:"fixed bottom-0 right-0 z-9999 inline-block overflow-hidden text-left align-middle transition-all bg-white shadow-xl mx-auto max-w-lg w-full md:w-[345px] border border-grey h-full lg:h-[450px] ".concat(_?"block":"hidden"),children:(0,j.jsxs)("div",{className:"border-0 relative flex flex-col w-full bg-white outline-none focus:outline-none",children:[(0,j.jsx)("div",{className:"absolute top-0 right-0 items-start justify-end z-10",children:(0,j.jsx)("button",{className:"p-2 ml-auto bg-transparent border-0 text-black float-right text-3xl leading-none font-semibold outline-none focus:outline-none",onClick:function(){return S(!_)},children:(0,j.jsx)("span",{className:"bg-transparent text-black text-2xl flex outline-none focus:outline-none",children:(0,j.jsx)(s.default,{src:"/assets/images/close.svg",alt:"",width:15,height:15})})})}),(0,j.jsxs)("div",{className:"relative flex-auto",children:[(0,j.jsxs)("div",{className:"info flex text-sm items-baseline p-3",children:[(0,j.jsxs)("p",{className:"font-helveticaNeue500 text-dark",children:[(0,j.jsxs)("span",{className:"uppercase font-helveticaNeue500 text-[14px]",children:[H&&K?W?K.first_name:H.first_name:Z?Z.first_name:""," "]}),H&&K?"@".concat(W?K.nickname:H.nickname):Z?"@".concat(Z.nickname):""]}),(0,j.jsxs)("div",{className:"font-helveticaNeue500 ratings flex items-center text-pink text-sm",children:[(0,j.jsx)("i",{className:"bg-rating-full inline-block w-3 h-3 bg-no-repeat bg-center bg-100% m-1"}),(0,j.jsx)("i",{className:"bg-rating-full inline-block w-3 h-3 bg-no-repeat bg-center bg-100% m-1"}),(0,j.jsx)("i",{className:"bg-rating-full inline-block w-3 h-3 bg-no-repeat bg-center bg-100% m-1"}),(0,j.jsx)("i",{className:"bg-rating-half inline-block w-3 h-3 bg-no-repeat bg-center bg-100% m-1"}),(0,j.jsx)("i",{className:"bg-rating-blank inline-block w-3 h-3 bg-no-repeat bg-center bg-100% m-1"})]})]}),(0,j.jsxs)("div",{className:"flex mb-4 space-x-3 px-3 font-helveticaNeue500",children:[(0,j.jsx)(s.default,{loader:g.k,src:null===C||void 0===C?void 0:C.media.data[0].original_image,alt:"image",width:54,height:68,objectFit:"cover"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"uppercase font-helveticaNeue500 text-[14px]",children:null===C||void 0===C?void 0:C.name}),(0,j.jsxs)("p",{className:"mb-3 font-helveticaNeue text-[14px]",children:[null===C||void 0===C||null===(t=C.currency)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.symbol,null===C||void 0===C?void 0:C.price]}),(null===C||void 0===C||null===(c=C.size)||void 0===c||null===(d=c.data)||void 0===d?void 0:d.name)&&(0,j.jsxs)("p",{className:"uppercase font-helveticaNeue text-[12px]",children:["SIZE:"," ",null!==C&&void 0!==C&&null!==(b=C.size)&&void 0!==b&&null!==(y=b.data)&&void 0!==y&&y.name?null===C||void 0===C||null===(k=C.size)||void 0===k||null===(w=k.data)||void 0===w?void 0:w.name:"Size"]})]})]}),(0,j.jsx)("div",{className:"border border-l-0 border-r-0 border-t-grey bg-lightGrey px-6 h-[80vh] lg:h-[272px] scrollbar scrollbar-thin overflow-y-auto pt-3",ref:ee,children:T&&T.length>0&&T.filter((function(e){return!N.K4.includes(e.type)})).map((function(e){return(0,j.jsxs)("div",{className:"message flex items-start space-x-4 mb-4 ".concat(e.sender_id===(null===M||void 0===M?void 0:M.id)?"flex-row-reverse space-x-reverse":""),children:[(0,j.jsx)("div",{className:"flex-shrink-0",children:(0,j.jsx)(s.default,{loader:g.k,src:e.user.data.customer.data.profile_picture||"/assets/images/Default_Profile.svg",alt:"",width:48,height:48,className:"rounded-full",objectFit:"cover"})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"bg-grey p-3 font-helveticaNeue400 text-[14px] ".concat(e.sender_id===(null===M||void 0===M?void 0:M.id)?"rounded-tr-[10px] rounded-tl-[10px] rounded-bl-[10px]":"rounded-tl-[10px] rounded-tr-[10px] rounded-br-[10px]"),children:e.message}),(0,j.jsx)("p",{className:"font-helveticaNeue400 pt-[8px] text-[12px]",children:f()(e.created_at).format("DD-MM-YY HH:mm")})]})]},e.id)}))}),(0,j.jsxs)("form",{className:"flex",name:"form",onSubmit:$.handleSubmit,children:[(0,j.jsx)(h.Z,{name:"message",classes:"w-full placeholder:text-mgrey !h-full border border-l-0 border-r-0 border-t-0 border-b-grey p-4",placeholder:"Type your message",onChange:$.handleChange,value:$.values.message,wraperClasses:"w-full",autoComplete:"off"}),(0,j.jsx)("button",{className:"bg-grey uppercase text-xs px-6 py-5 font-helveticaNeue500",type:"submit",disabled:L||I,children:L||I?"Sending":"Send"})]})]})]})})}},69094:function(e,t,n){n.d(t,{_:function(){return b}});var r=n(15861),a=n(87757),s=n.n(a),i=n(67294),l=n(25675),o=n(4565),c=n(94649),u=n(27335),d=n(97e3),f=n(77256),m=n(87517),x=n(73534),h=n(22887),p=n(85893),b=function(e){var t,n=e.toggleMakeAnOfferModal,a=e.active,b=e.productDetail,v=e.counterOffer,g=e.offer,N=(0,i.useState)(""),j=N[0],y=N[1],k=(0,x.e)().data,w=(0,o.Nl)(),_=w.mutate,S=w.isLoading,C=w.isSuccess,M=w.error,O=(0,o.yf)(),Z=O.mutate,E=O.error,T=O.isLoading,z=O.isSuccess,F=(0,o.pY)().refetch,P=(0,m.u)((function(e){return e.browserCurrency})),R=function(){var e=(0,r.Z)(s().mark((function e(t){var n,r,a,i,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Math.floor(A.values.initial_amount/t),b&&b.base_currency_price){e.next=4;break}return y("Unable to make an offer: currency"),e.abrupt("return",!1);case 4:if(v){e.next=9;break}if(r=.8*Math.ceil(b.base_currency_price),!(n<=Math.ceil(r))){e.next=9;break}return y("Offer must be no less than 80% of the asking price"),e.abrupt("return",!1);case 9:if(!v||!g||g.buyer_username!==(null===k||void 0===k?void 0:k.customer.data.nickname)){e.next=18;break}if(a=g.buyer_prev_offer?g.buyer_prev_offer:0,i=g.amount,!(n<=Math.ceil(a))){e.next=15;break}return y("Counter offer must be higher than the original offer"),e.abrupt("return",!1);case 15:if(!(n>=Math.ceil(i))){e.next=18;break}return y("Counter offer must be lower than seller's offer"),e.abrupt("return",!1);case 18:if(!v||!g||g.seller_username!==(null===k||void 0===k?void 0:k.customer.data.nickname)){e.next=23;break}if(l=g.buyer_prev_offer?g.buyer_prev_offer:g.amount,!(n<=Math.ceil(l))){e.next=23;break}return y("Counter offer must be higher than the original offer"),e.abrupt("return",!1);case 23:if(!(n>=Math.ceil(Math.ceil(b.base_currency_price)))){e.next=26;break}return y("Offer amount must be lower than original price"),e.abrupt("return",!1);case 26:return e.abrupt("return",n);case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=(0,c.TA)({enableReinitialize:!0,initialValues:{initial_amount:0},onSubmit:function(){var e=(0,r.Z)(s().mark((function e(){var t,n,r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P&&P.currencies?(n=P.currencies.find((function(e){return e.code===P.currency})),t=(null===(r=n)||void 0===r?void 0:r.rate)||1):t=1,e.next=3,R(t);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return");case 6:if(!v||!g){e.next=9;break}return Z({offer_id:g.id,status:"COUNTERED",amount:a},{onSuccess:function(){return F()}}),e.abrupt("return");case 9:b&&n&&_({initial_amount:a,product_id:b.id.toString(),currency_id:n.id});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()});return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)("div",{className:"overflow-x-hidden overflow-y-auto fixed inset-0 z-99999 h-screen outline-none focus:outline-none justify-center c-modal bg-dark bg-opacity-75 ".concat(a?"":"hidden"),id:"makeAnOffer-modal",children:(0,p.jsx)("div",{className:"relative my-6 mx-auto w-11/12 md:w-420",children:(0,p.jsxs)("div",{className:"border-0  relative flex flex-col w-full bg-white outline-none focus:outline-none",children:[(0,p.jsx)("div",{className:"flex items-start justify-end px-4 py-4",children:(0,p.jsx)("button",{className:"p-1 ml-auto bg-transparent border-0 text-black float-right text-3xl leading-none font-semibold outline-none focus:outline-none",onClick:n,children:(0,p.jsx)("span",{className:"bg-transparent text-black text-2xl block outline-none focus:outline-none w-[20px] h-[20px] relative",children:(0,p.jsx)(l.default,{src:"/assets/images/close.svg",alt:"",layout:"fill"})})})}),(0,p.jsx)("div",{className:"relative flex-auto pb-16 px-6",children:(0,p.jsxs)("div",{className:"text-center text-sm",children:[(0,p.jsx)("h3",{className:"font-helveticaNeue500 text-2xl uppercase mb-4",children:v?"COUNTER OFFER":"Make an offer"}),(0,p.jsx)("p",{children:"Your offer will be submitted to the seller and they will have 2 days to respond."}),(0,p.jsxs)("div",{className:"product-popup mt-8 mb-8 flex w-full text-left",children:[(0,p.jsx)("div",{className:"thumb w-100",children:(0,p.jsx)("a",{href:"#",children:b?(0,p.jsx)(l.default,{loader:d.k,className:"w-full",src:b.media.data[0].original_image,alt:"",width:"100%",height:"100%"}):""})}),(0,p.jsxs)("div",{className:"info flex-1 text-sm pl-4",children:[(0,p.jsx)("h3",{className:"font-helveticaNeue500 uppercase mb-1",children:null===b||void 0===b?void 0:b.name}),b?(0,p.jsx)("p",{children:(0,p.jsx)(f.Z,{price:b.base_currency_price})}):"",(0,p.jsx)("br",{}),(0,p.jsxs)("p",{children:["SIZE: ",null===b||void 0===b||null===(t=b.size)||void 0===t?void 0:t.data.name]})]})]}),(0,p.jsx)("div",{className:"text-left",children:(0,p.jsxs)("form",{onSubmit:A.handleSubmit,children:[(0,p.jsxs)("div",{className:"mb-6",children:[(0,p.jsx)(u.Z,{disabled:C||S,name:"initial_amount",label:v?"COUNTER OFFER AMOUNT":"Offer amount",onChange:A.handleChange,value:A.values.initial_amount.toString(),labelClasses:"text-sm mb-2",wraperClasses:"grow mr-2"}),j&&!C&&!z&&(0,p.jsx)("div",{className:"input-response text-pink mt-1 text-xs",children:j}),!S&&!C&&M&&(0,p.jsx)(h.Z,{message:M.message}),E&&(0,p.jsx)("div",{className:"pl-2",children:(0,p.jsx)(h.Z,{message:E.message})})]}),(0,p.jsx)("div",{className:"mb-0",children:(0,p.jsx)("button",{disabled:C||S,type:"submit",className:"font-helveticaNeue500 text-center px-3 py-4 transition-all border ".concat(C?"text-white bg-kelly_green border-kelly_green":"text-kelly_green border-kelly_green hover:border-kelly_green hover:text-white hover:bg-kelly_green"," text-xs w-full tracking-widest uppercase"),children:S||T?"Submitting":C||z?"Submitted":"Submit"})})]})})]})})]})})})})}},82069:function(e,t,n){var r=n(67294),a=n(25675),s=n(85893);t.Z=function(e){var t=e.rate,n=e.values,i=e.size||12,l=(0,r.useState)(0),o=l[0],c=l[1],u=(0,r.useState)(!1),d=u[0],f=u[1];return(0,r.useEffect)((function(){!function(){var e=parseInt(t.toString()),n=t-e;e>0&&c(e),n>0&&f(!0)}()}),[t]),(0,s.jsxs)("div",{className:"flex",children:[function(){for(var e=[],t=0;t<5;t++)e.push("rating-".concat(t+1));return e}().map((function(e,t){return(0,s.jsx)("div",{className:"mr-[4px]",children:t<o?(0,s.jsx)(a.default,{className:"cursor-pointer",src:"/assets/icons/rating-1.svg",alt:"icon rating",width:i,height:i}):d&&t===o?(0,s.jsx)(a.default,{className:"cursor-pointer",src:"/assets/icons/rating-2.svg",alt:"icon rating",width:i,height:i}):(0,s.jsx)(a.default,{className:"cursor-pointer",src:"/assets/icons/rating-3.svg",alt:"icon rating",width:i,height:i})},e.toString())})),(0,s.jsxs)("span",{className:"text-pink ".concat(i>12?"text-[14px] pt-[1px]":"text-[12px] -mt-[2px]"),children:["(",n,")"]})]})}},4565:function(e,t,n){n.d(t,{Nl:function(){return i},pY:function(){return l},yf:function(){return o}});var r=n(46837),a=n(88767),s=n(5887),i=function(){return(0,a.useMutation)((function(e){return(0,r.h)("offers",{method:"POST",body:JSON.stringify(e)})}))},l=function(){var e=(0,s.J)().isLoggedIn;return(0,a.useQuery)("my-offers",(function(){return(0,r.h)("offers")}),{enabled:!!e})},o=function(){return(0,a.useMutation)((function(e){return(0,r.h)("offers/".concat(e.offer_id),{method:"PUT",body:JSON.stringify(e)})}))}},64111:function(e,t,n){n.d(t,{s:function(){return s}});var r=n(46837),a=n(88767),s=function(){return(0,a.useMutation)((function(e){return(0,r.h)("inbox/conversations/".concat(e.conversation_id,"/messages"),{method:"POST",body:JSON.stringify({message:e.message})})}),{})}}}]);